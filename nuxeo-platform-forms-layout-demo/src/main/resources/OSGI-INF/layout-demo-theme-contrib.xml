<?xml version="1.0"?>
<component name="org.nuxeo.ecm.platform.forms.layoutDemo.theme.contrib">

  <require>org.nuxeo.theme.core</require>
  <require>org.nuxeo.theme.fragments</require>
  <require>org.nuxeo.theme.html</require>
  <require>org.nuxeo.theme.jsf</require>

  <!-- redefine the theme negotiator to use a given theme in layoutDemo application -->
  <require>org.nuxeo.theme.nuxeo.default</require>

  <!-- themes -->
  <extension target="org.nuxeo.theme.services.ThemeService" point="themes">

    <theme>
      <src>themes/layout-demo.xml</src>
    </theme>

  </extension>

  <extension target="org.nuxeo.theme.services.ThemeService" point="views">

    <view name="Nuxeo layoutDemo header" template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>layoutDemo/header.xhtml</template>
      <resource>screen.css</resource>
    </view>

    <view name="Nuxeo layoutDemo footer" template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>layoutDemo/footer.xhtml</template>
    </view>

  </extension>

  <extension target="org.nuxeo.ecm.platform.WebResources" point="resources">

    <resource name="layoutDemo.css">
      <uri>/layoutDemo/style/layoutDemo.css</uri>
    </resource>
    <resource name="layoutDemo.js">
      <uri>/layoutDemo/scripts/layoutDemo.js</uri>
    </resource>
    <resource name="prettify.css">
      <uri>/layoutDemo/style/prettify.css</uri>
    </resource>
    <resource name="prettify.js">
      <uri>/layoutDemo/scripts/prettify.js</uri>
    </resource>
    <resource name="layoutDemo-ga.js">
      <uri>/layoutDemo/scripts/ga.js</uri>
    </resource>

  </extension>

  <extension target="org.nuxeo.ecm.platform.WebResources" point="resourceBundles">

    <resourceBundle name="layoutDemo">
      <resources>
        <resource>layoutDemo.css</resource>
        <resource>layoutDemo.js</resource>
        <resource>prettify.css</resource>
        <resource>prettify.js</resource>
        <resource>layoutDemo-ga.js</resource>
      </resources>
    </resourceBundle>

  </extension>

  <!-- Register mapping between theme pages and resources -->
  <extension target="org.nuxeo.theme.styling.service" point="pages">

    <page name="layoutDemo/default" charset="utf-8">
      <links>
        <icon name="icon">${org.nuxeo.ecm.contextPath}/icons/favicon.png</icon>
        <icon name="shortcut icon">${org.nuxeo.ecm.contextPath}/icons/favicon.ico</icon>
      </links>
      <defaultFlavor>default</defaultFlavor>
      <resources>
        <bundle>nuxeo_includes</bundle>
        <bundle>nuxeo_base</bundle>
        <bundle>nuxeo_header_footer</bundle>
        <bundle>layoutDemo</bundle>
        <resource>screen.css</resource>
      </resources>
    </page>

    <themePage name="layoutDemo/frame" charset="utf-8">
      <favorites>
        <icon name="icon">${org.nuxeo.ecm.contextPath}/icons/favicon.png</icon>
        <icon name="shortcut icon">${org.nuxeo.ecm.contextPath}/icons/favicon.ico</icon>
      </favorites>
      <defaultFlavor>default</defaultFlavor>
      <resources>
        <bundle>nuxeo_includes</bundle>
        <bundle>nuxeo_base</bundle>
      </resources>
    </themePage>

  </extension>

  <extension target="org.nuxeo.theme.services.ThemeService" point="negotiations">

    <negotiation object="theme" strategy="nuxeo5">
      <scheme>org.nuxeo.theme.jsf.negotiation.theme.RequestParameter</scheme>
      <scheme>org.nuxeo.theme.jsf.negotiation.theme.CookieValue</scheme>
      <scheme>org.nuxeo.theme.jsf.negotiation.theme.ViewId</scheme>
      <!-- local theme (specific to nuxeo5) -->
      <scheme>org.nuxeo.ecm.localconf.LocalTheme</scheme>
      <!-- popup theme (specific to layoutDemo) -->
      <scheme>org.nuxeo.ecm.platform.forms.layout.demo.jsf.LayoutDemoTheme
      </scheme>
    </negotiation>

  </extension>

</component>
